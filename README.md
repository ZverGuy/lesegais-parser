# lesegais/deal parser
Простой парсер который собирает информацию с https://www.lesegais.ru/open-area/deal и отправляет в mysql

# Алгоритм работы
При запуске программы после загрузки приложение запрашивает количество записей в mysql базы данных, чтобы убедиться база пустая или нет. 
Далее происходит запрос с GraphQL серверу, чтобы узнать количество записей всего.
Это необходимо для пропуска проверки уникальности по ключу, тк в этом случае проверка не нужна.

Далее происходит запуск бесконечного цикла со следующими этапами
- Парсинг
- Валидация
- Взаимодействие с базой данной (запись и проверка по ключу)


# Парсинг
Парсинг данных реализован путем прямых обращений к GraphQL и последующей сериализацией и валидацией.

Размер данных за 1 запрос - 1000 записей

Обоснование: при запросе 1000 записей время до ответа не слишком долгое. Также количество записей в минуту не увеличивается при большом количестве записей (т.е слабое место - бд, либо слой взаимодействия с бд)
# Валидация
После сериализации в промежуточную модель в классе SearchWoodModelValidator происходит валидация.

Покрытые кейсы валидации:
1. Имя продавца не пустое
2. Имя покупателя не пустое
3. ИНН продавца не пустой и содержит цифры (при включенной строгой валидации)
4. ИНН Покупателя не пустой и содержит цифры (при включенной строгой валидации)
5. Дата сделки находится в промежутки между 1900 годом и текущей датой.

Обоснования:
1. Потому что не может быть в реальности что название компании продавца было пустым
2. Тоже самое что и 1 пункт
3. 
